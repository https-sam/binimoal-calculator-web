{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SVGmo = void 0;\n\nvar Wrapper_js_1 = require(\"../Wrapper.js\");\n\nvar mo_js_1 = require(\"../../common/Wrappers/mo.js\");\n\nvar mo_js_2 = require(\"../../../core/MmlTree/MmlNodes/mo.js\");\n\nvar VFUZZ = 0.1;\nvar HFUZZ = 0.1;\n\nvar SVGmo = function (_super) {\n  __extends(SVGmo, _super);\n\n  function SVGmo() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  SVGmo.prototype.toSVG = function (parent) {\n    var attributes = this.node.attributes;\n    var symmetric = attributes.get('symmetric') && this.stretch.dir !== 2;\n    var stretchy = this.stretch.dir !== 0;\n\n    if (stretchy && this.size === null) {\n      this.getStretchedVariant([]);\n    }\n\n    var svg = this.standardSVGnode(parent);\n\n    if (stretchy && this.size < 0) {\n      this.stretchSVG();\n    } else {\n      var u = symmetric || attributes.get('largeop') ? this.fixed(this.getCenterOffset()) : '0';\n      var v = this.node.getProperty('mathaccent') ? this.fixed(this.getAccentOffset()) : '0';\n\n      if (u !== '0' || v !== '0') {\n        this.adaptor.setAttribute(svg, 'transform', \"translate(\" + v + \" \" + u + \")\");\n      }\n\n      this.addChildren(svg);\n    }\n  };\n\n  SVGmo.prototype.stretchSVG = function () {\n    var stretch = this.stretch.stretch;\n    var variants = this.getStretchVariants();\n    var bbox = this.getBBox();\n\n    if (this.stretch.dir === 1) {\n      this.stretchVertical(stretch, variants, bbox);\n    } else {\n      this.stretchHorizontal(stretch, variants, bbox);\n    }\n  };\n\n  SVGmo.prototype.getStretchVariants = function () {\n    var e_1, _a;\n\n    var c = this.stretch.c || this.getText().codePointAt(0);\n    var variants = [];\n\n    try {\n      for (var _b = __values(this.stretch.stretch.keys()), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var i = _c.value;\n        variants[i] = this.font.getStretchVariant(c, i);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n\n    return variants;\n  };\n\n  SVGmo.prototype.stretchVertical = function (stretch, variant, bbox) {\n    var h = bbox.h,\n        d = bbox.d,\n        w = bbox.w;\n    var T = this.addTop(stretch[0], variant[0], h, w);\n    var B = this.addBot(stretch[2], variant[2], d, w);\n\n    if (stretch.length === 4) {\n      var _a = __read(this.addMidV(stretch[3], variant[3], w), 2),\n          H = _a[0],\n          D = _a[1];\n\n      this.addExtV(stretch[1], variant[1], h, 0, T, H, w);\n      this.addExtV(stretch[1], variant[1], 0, d, D, B, w);\n    } else {\n      this.addExtV(stretch[1], variant[1], h, d, T, B, w);\n    }\n  };\n\n  SVGmo.prototype.stretchHorizontal = function (stretch, variant, bbox) {\n    var w = bbox.w;\n    var L = this.addLeft(stretch[0], variant[0]);\n    var R = this.addRight(stretch[2], variant[2], w);\n\n    if (stretch.length === 4) {\n      var _a = __read(this.addMidH(stretch[3], variant[3], w), 2),\n          x1 = _a[0],\n          x2 = _a[1];\n\n      var w2 = w / 2;\n      this.addExtH(stretch[1], variant[1], w2, L, w2 - x1);\n      this.addExtH(stretch[1], variant[1], w2, x2 - w2, R, w2);\n    } else {\n      this.addExtH(stretch[1], variant[1], w, L, R);\n    }\n  };\n\n  SVGmo.prototype.getChar = function (n, variant) {\n    var char = this.font.getChar(variant, n) || [0, 0, 0, null];\n    return [char[0], char[1], char[2], char[3] || {}];\n  };\n\n  SVGmo.prototype.addGlyph = function (n, variant, x, y, parent) {\n    if (parent === void 0) {\n      parent = null;\n    }\n\n    return this.placeChar(n, x, y, parent || this.element, variant);\n  };\n\n  SVGmo.prototype.addTop = function (n, v, H, W) {\n    if (!n) return 0;\n\n    var _a = __read(this.getChar(n, v), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    this.addGlyph(n, v, (W - w) / 2, H - h);\n    return h + d;\n  };\n\n  SVGmo.prototype.addExtV = function (n, v, H, D, T, B, W) {\n    var _this = this;\n\n    if (!n) return;\n    T = Math.max(0, T - VFUZZ);\n    B = Math.max(0, B - VFUZZ);\n    var adaptor = this.adaptor;\n\n    var _a = __read(this.getChar(n, v), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    var Y = H + D - T - B;\n    var s = 1.5 * Y / (h + d);\n    var y = (s * (h - d) - Y) / 2;\n    if (Y <= 0) return;\n    var svg = this.svg('svg', {\n      width: this.fixed(w),\n      height: this.fixed(Y),\n      y: this.fixed(B - D),\n      x: this.fixed((W - w) / 2),\n      viewBox: [0, y, w, Y].map(function (x) {\n        return _this.fixed(x);\n      }).join(' ')\n    });\n    this.addGlyph(n, v, 0, 0, svg);\n    var glyph = adaptor.lastChild(svg);\n    adaptor.setAttribute(glyph, 'transform', \"scale(1,\" + this.jax.fixed(s) + \")\");\n    adaptor.append(this.element, svg);\n  };\n\n  SVGmo.prototype.addBot = function (n, v, D, W) {\n    if (!n) return 0;\n\n    var _a = __read(this.getChar(n, v), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    this.addGlyph(n, v, (W - w) / 2, d - D);\n    return h + d;\n  };\n\n  SVGmo.prototype.addMidV = function (n, v, W) {\n    if (!n) return [0, 0];\n\n    var _a = __read(this.getChar(n, v), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    var y = (d - h) / 2 + this.font.params.axis_height;\n    this.addGlyph(n, v, (W - w) / 2, y);\n    return [h + y, d - y];\n  };\n\n  SVGmo.prototype.addLeft = function (n, v) {\n    return n ? this.addGlyph(n, v, 0, 0) : 0;\n  };\n\n  SVGmo.prototype.addExtH = function (n, v, W, L, R, x) {\n    var _this = this;\n\n    if (x === void 0) {\n      x = 0;\n    }\n\n    if (!n) return;\n    R = Math.max(0, R - HFUZZ);\n    L = Math.max(0, L - HFUZZ);\n    var adaptor = this.adaptor;\n\n    var _a = __read(this.getChar(n, v), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    var X = W - L - R;\n    var Y = h + d + 2 * VFUZZ;\n    var s = 1.5 * (X / w);\n    var D = -(d + VFUZZ);\n    if (X <= 0) return;\n    var svg = this.svg('svg', {\n      width: this.fixed(X),\n      height: this.fixed(Y),\n      x: this.fixed(x + L),\n      y: this.fixed(D),\n      viewBox: [(s * w - X) / 2, D, X, Y].map(function (x) {\n        return _this.fixed(x);\n      }).join(' ')\n    });\n    this.addGlyph(n, v, 0, 0, svg);\n    var glyph = adaptor.lastChild(svg);\n    adaptor.setAttribute(glyph, 'transform', 'scale(' + this.jax.fixed(s) + ',1)');\n    adaptor.append(this.element, svg);\n  };\n\n  SVGmo.prototype.addRight = function (n, v, W) {\n    if (!n) return 0;\n    var w = this.getChar(n, v)[2];\n    return this.addGlyph(n, v, W - w, 0);\n  };\n\n  SVGmo.prototype.addMidH = function (n, v, W) {\n    if (!n) return [0, 0];\n    var w = this.getChar(n, v)[2];\n    this.addGlyph(n, v, (W - w) / 2, 0);\n    return [(W - w) / 2, (W + w) / 2];\n  };\n\n  SVGmo.kind = mo_js_2.MmlMo.prototype.kind;\n  return SVGmo;\n}(mo_js_1.CommonMoMixin(Wrapper_js_1.SVGWrapper));\n\nexports.SVGmo = SVGmo;","map":{"version":3,"sources":["/Users/sam/Desktop/projects/Binomial_expansion/Web/binomial/node_modules/mathjax-full/ts/output/svg/Wrappers/mo.ts"],"names":[],"mappings":"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","sourcesContent":["\n/*************************************************************\n *\n *  Copyright (c) 2018-2021 The MathJax Consortium\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\n/**\n * @fileoverview  Implements the SVGmo wrapper for the MmlMo object\n *\n * @author dpvc@mathjax.org (Davide Cervone)\n */\n\nimport {SVGWrapper, SVGConstructor} from '../Wrapper.js';\nimport {CommonMoMixin} from '../../common/Wrappers/mo.js';\nimport {MmlMo} from '../../../core/MmlTree/MmlNodes/mo.js';\nimport {BBox} from '../../../util/BBox.js';\nimport {DIRECTION, SVGCharData, SVGCharOptions} from '../FontData.js';\n\n\n/*****************************************************************/\n\nconst VFUZZ = 0.1;       // overlap for vertical stretchy glyphs\nconst HFUZZ = 0.1;       // overlap for horizontal stretchy glyphs\n\n/*****************************************************************/\n/**\n * The SVGmo wrapper for the MmlMo object\n *\n * @template N  The HTMLElement node class\n * @template T  The Text node class\n * @template D  The Document class\n */\n// @ts-ignore\nexport class SVGmo<N, T, D> extends\nCommonMoMixin<SVGConstructor<any, any, any>>(SVGWrapper) {\n\n  /**\n   * The mo wrapper\n   */\n  public static kind = MmlMo.prototype.kind;\n\n  /**\n   * @override\n   */\n  public toSVG(parent: N) {\n    const attributes = this.node.attributes;\n    const symmetric = (attributes.get('symmetric') as boolean) && this.stretch.dir !== DIRECTION.Horizontal;\n    const stretchy = this.stretch.dir !== DIRECTION.None;\n    if (stretchy && this.size === null) {\n      this.getStretchedVariant([]);\n    }\n    let svg = this.standardSVGnode(parent);\n    if (stretchy && this.size < 0) {\n      this.stretchSVG();\n    } else {\n      const u = (symmetric || attributes.get('largeop') ? this.fixed(this.getCenterOffset()) : '0');\n      const v = (this.node.getProperty('mathaccent') ? this.fixed(this.getAccentOffset()) : '0');\n      if (u !== '0' || v !== '0') {\n        this.adaptor.setAttribute(svg, 'transform', `translate(${v} ${u})`);\n      }\n      this.addChildren(svg);\n    }\n  }\n\n  /**\n   * Create the SVG for a multi-character stretchy delimiter\n   */\n  protected stretchSVG() {\n    const stretch = this.stretch.stretch;\n    const variants = this.getStretchVariants();\n    const bbox = this.getBBox();\n    if (this.stretch.dir === DIRECTION.Vertical) {\n      this.stretchVertical(stretch, variants, bbox);\n    } else {\n      this.stretchHorizontal(stretch, variants, bbox);\n    }\n  }\n\n  /**\n   * Get the variant array for the assembly pieces\n   */\n  protected getStretchVariants() {\n    const c = this.stretch.c || this.getText().codePointAt(0);\n    const variants = [] as string[];\n    for (const i of this.stretch.stretch.keys()) {\n      variants[i] = this.font.getStretchVariant(c, i);\n    }\n    return variants;\n  }\n\n  /**\n   * @param {number[]} stretch    The characters to use for stretching\n   * @param {string[]} variant    The variants for the parts to use for stretching\n   * @param {BBox} bbox           The full size of the stretched character\n   */\n  protected stretchVertical(stretch: number[], variant: string[], bbox: BBox) {\n    const {h, d, w} = bbox;\n    const T = this.addTop(stretch[0], variant[0], h, w);\n    const B = this.addBot(stretch[2], variant[2], d, w);\n    if (stretch.length === 4) {\n      const [H, D] = this.addMidV(stretch[3], variant[3], w);\n      this.addExtV(stretch[1], variant[1], h, 0, T, H, w);\n      this.addExtV(stretch[1], variant[1], 0, d, D, B, w);\n    } else {\n      this.addExtV(stretch[1], variant[1], h, d, T, B, w);\n    }\n  }\n\n  /**\n   * @param {number[]} stretch    The characters to use for stretching\n   * @param {string[]} variant    The variants for the parts to use for stretching\n   * @param {BBox} bbox           The full size of the stretched character\n   */\n  protected stretchHorizontal(stretch: number[], variant: string[], bbox: BBox) {\n    const w = bbox.w;\n    const L = this.addLeft(stretch[0], variant[0]);\n    const R = this.addRight(stretch[2], variant[2], w);\n    if (stretch.length === 4) {\n      const [x1, x2] = this.addMidH(stretch[3], variant[3], w);\n      const w2 = w / 2;\n      this.addExtH(stretch[1], variant[1], w2, L, w2 - x1);\n      this.addExtH(stretch[1], variant[1], w2, x2 - w2, R, w2);\n    } else {\n      this.addExtH(stretch[1], variant[1], w, L, R);\n    }\n  }\n\n  /***********************************************************/\n\n  /**\n   * @param {number} n         The number of the character to look up\n   * @param {string} variant   The variant for the character to look up\n   * @return {SVGCharData}     The full CharData object, with CharOptions guaranteed to be defined\n   */\n  protected getChar(n: number, variant: string): SVGCharData {\n    const char = this.font.getChar(variant, n) || [0, 0, 0, null];\n    return [char[0], char[1], char[2], char[3] || {}] as [number, number, number, SVGCharOptions];\n  }\n\n  /**\n   * @param {number} n         The character code for the glyph\n   * @param {string} variant   The variant for the glyph\n   * @param {number} x         The x position of the glyph\n   * @param {number} y         The y position of the glyph\n   * @param {N} parent         The container for the glyph\n   * @return {number}          The width of the character placed\n   */\n  protected addGlyph(n: number, variant: string, x: number, y: number, parent: N = null): number {\n    return this.placeChar(n, x, y, parent || this.element, variant);\n  }\n\n  /***********************************************************/\n\n  /**\n   * @param {number} n    The character number for the top glyph\n   * @param {string} v    The variant for the top glyph\n   * @param {number} H    The height of the stretched delimiter\n   * @param {number} W    The width of the stretched delimiter\n   * @return {number}     The total height of the top glyph\n   */\n  protected addTop(n: number, v: string, H: number, W: number): number {\n    if (!n)  return 0;\n    const [h, d, w] = this.getChar(n, v);\n    this.addGlyph(n, v, (W - w) / 2, H - h);\n    return h + d;\n  }\n\n  /**\n   * @param {number} n    The character number for the extender glyph\n   * @param {string} v    The variant for the extender glyph\n   * @param {number} H    The height of the stretched delimiter\n   * @param {number} D    The depth of the stretched delimiter\n   * @param {number} T    The height of the top glyph in the delimiter\n   * @param {number} B    The height of the bottom glyph in the delimiter\n   * @param {number} W    The width of the stretched delimiter\n   */\n  protected addExtV(n: number, v: string, H: number, D: number, T: number, B: number, W: number) {\n    if (!n) return;\n    T = Math.max(0, T - VFUZZ);              // A little overlap on top\n    B = Math.max(0, B - VFUZZ);              // A little overlap on bottom\n    const adaptor = this.adaptor;\n    const [h, d, w] = this.getChar(n, v);\n    const Y = H + D - T - B;                 // The height of the extender\n    const s = 1.5 * Y / (h + d);             // Scale height by 1.5 to avoid bad ends\n    //   (glyphs with rounded or anti-aliased ends don't stretch well,\n    //    so this makes for sharper ends)\n    const y = (s * (h - d) - Y) / 2;         // The bottom point to clip the extender\n    if (Y <= 0) return;\n    const svg = this.svg('svg', {\n      width: this.fixed(w), height: this.fixed(Y),\n      y: this.fixed(B - D), x: this.fixed((W - w) / 2),\n      viewBox: [0, y, w, Y].map(x => this.fixed(x)).join(' ')\n    });\n    this.addGlyph(n, v, 0, 0, svg);\n    const glyph = adaptor.lastChild(svg);\n    adaptor.setAttribute(glyph, 'transform', `scale(1,${this.jax.fixed(s)})`);\n    adaptor.append(this.element, svg);\n  }\n\n  /**\n   * @param {number} n    The character number for the bottom glyph\n   * @param {string} v    The variant for the bottom glyph\n   * @param {number} D    The depth of the stretched delimiter\n   * @param {number} W    The width of the stretched delimiter\n   * @return {number}     The total height of the bottom glyph\n   */\n  protected addBot(n: number, v: string, D: number, W: number): number {\n    if (!n) return 0;\n    const [h, d, w] = this.getChar(n, v);\n    this.addGlyph(n, v, (W - w) / 2, d - D);\n    return h + d;\n  }\n\n  /**\n   * @param {number} n    The character number for the middle glyph\n   * @param {string} v    The variant for the middle glyph\n   * @param {number} W    The width of the stretched delimiter\n   * @return {[number, number]}   The top and bottom positions of the middle glyph\n   */\n  protected addMidV(n: number, v: string, W: number): [number, number] {\n    if (!n) return [0, 0];\n    const [h, d, w] = this.getChar(n, v);\n    const y = (d - h) / 2 + this.font.params.axis_height;\n    this.addGlyph(n, v, (W - w) / 2, y);\n    return [h + y, d - y];\n  }\n\n  /***********************************************************/\n\n  /**\n   * @param {number} n   The character number for the left glyph of the stretchy character\n   * @param {string} v   The variant for the left glyph\n   * @return {number}    The width of the left glyph\n   */\n  protected addLeft(n: number, v: string): number {\n    return (n ? this.addGlyph(n, v, 0, 0) : 0);\n  }\n\n  /**\n   * @param {number} n   The character number for the extender glyph of the stretchy character\n   * @param {string} v   The variant for the extender glyph\n   * @param {number} W   The width of the stretched character\n   * @param {number} L   The width of the left glyph of the stretchy character\n   * @param {number} R   The width of the right glyph of the stretchy character\n   * @param {number} x   The x-position of the extender (needed for ones with two extenders)\n   */\n  protected addExtH(n: number, v: string, W: number, L: number, R: number, x: number = 0) {\n    if (!n) return;\n    R = Math.max(0, R - HFUZZ);     // A little less than the width of the right glyph\n    L = Math.max(0, L - HFUZZ);     // A little less than the width of the left glyph\n    const adaptor = this.adaptor;\n    const [h, d, w] = this.getChar(n, v);\n    const X = W - L - R;            // The width of the extender\n    const Y = h + d + 2 * VFUZZ;    // The height (plus some fuzz) of the extender\n    const s = 1.5 * (X / w);        // Scale the width so that left- and right-bearing won't hurt us\n    const D = -(d + VFUZZ);         // The bottom position of the glyph\n    if (X <= 0) return;\n    const svg = this.svg('svg', {\n      width: this.fixed(X), height: this.fixed(Y),\n      x: this.fixed(x + L), y: this.fixed(D),\n      viewBox: [(s * w - X) / 2, D, X, Y].map(x => this.fixed(x)).join(' ')\n    });\n    this.addGlyph(n, v, 0, 0, svg);\n    const glyph = adaptor.lastChild(svg);\n    adaptor.setAttribute(glyph, 'transform', 'scale(' + this.jax.fixed(s) + ',1)');\n    adaptor.append(this.element, svg);\n  }\n\n  /**\n   * @param {number} n   The character number for the right glyph of the stretchy character\n   * @param {string} v   The variant for the right glyph\n   * @param {number} W   The width of the stretched character\n   * @return {number}    The width of the right glyph\n   */\n  protected addRight(n: number, v: string, W: number): number {\n    if (!n) return 0;\n    const w = this.getChar(n, v)[2];\n    return this.addGlyph(n, v, W - w, 0);\n  }\n\n  /**\n   * @param {number} n   The character number for the middle glyph of the stretchy character\n   * @param {string} v   The variant for the middle glyph\n   * @param {number} W   The width of the stretched character\n   * @return {[number, number]}  The positions of the left and right edges of the middle glyph\n   */\n  protected addMidH(n: number, v: string, W: number): [number, number] {\n    if (!n) return [0, 0];\n    const w = this.getChar(n, v)[2];\n    this.addGlyph(n, v, (W - w) / 2, 0);\n    return [(W - w) / 2, (W + w) / 2];\n  }\n\n}\n"]},"metadata":{},"sourceType":"script"}